"use strict";(self.webpackChunkda_app=self.webpackChunkda_app||[]).push([[580],{1120:(e,a,t)=>{t.d(a,{c:()=>s});const s=t(8372).c.create({baseURL:"http://localhost:5000/api",headers:{Accept:"application/json","X-API-Key":"your_api_key","X-Secret":"API_secret_key"}})},9452:(e,a,t)=>{t.d(a,{c:()=>i});var s=t(2635),o=t(9120),r=t(692),n=t(2496);const l={indeterminate:e=>e},c=(0,n.jsx)(o.c,{}),i=e=>{let{title:a,columns:t,data:o,defaultSortFieldId:i,onSort:d,progressPending:u,progressComponent:p,fixedHeader:m,fixedHeaderScrollHeight:h,noHeader:x,pagination:w,paginationPerPage:f,paginationRowsPerPageOptions:g,paginationServer:b,expandableRows:j,expandableRowsComponent:C,expandOnRowClicked:S,expandOnRowDoubleClicked:v,expandableRowExpanded:y,expandableRowsHideExpander:R,onRowClicked:D,selectableRows:k,selectableRowsHighlight:H,selectableRowsComponent:L,onSelectedRowsChange:N,clearSelectedRows:E,striped:F,responsive:M,actions:U,subHeaderComponent:Y,contextActions:z,persistTableHead:P,defaultSortAsc:A,highlightOnHover:I,dense:T}=e;const O={header:{style:{minHeight:"56px"}},headRow:{style:{borderTopStyle:"solid",borderTopWidth:"1px",borderTopColor:s.Ep.default.divider.default}}};return(0,n.jsx)(s.cp,{className:"dataTables_wrapper",title:a,columns:t,data:o,sortIcon:c,defaultSortFieldId:i,defaultSortAsc:A,progressPending:u,progressComponent:p,fixedHeaderScrollHeight:h,pagination:!0,paginationPerPage:f,paginationRowsPerPageOptions:[5,10,15,20],paginationServer:b,expandableRows:!0,expandableRowsComponent:C,expandOnRowClicked:!0,expandOnRowDoubleClicked:v,expandableRowExpanded:y,expandableRowsHideExpander:!0,onRowClicked:D,selectableRows:!0,selectableRowsHighlight:!0,selectableRowsComponent:r.c,selectableRowsComponentProps:l,onSelectedRowsChange:N,clearSelectedRows:E,striped:!0,responsive:!0,customStyles:O,contextActions:z,subHeader:!0,subHeaderComponent:Y,persistTableHead:P,actions:U,highlightOnHover:!0,dense:T})}},8668:(e,a,t)=>{t.d(a,{c:()=>l});var s=t(5548),o=t(1784),r=t(7344),n=t(2496);const l=e=>{let{handleDelete:a,handleDownload:t}=e;return[(0,n.jsx)(s.c,{"aria-label":"icon download",onClick:t,children:(0,n.jsx)(r.c,{})},"icon-download"),(0,n.jsx)(s.c,{"aria-label":"icon delete",color:"warning",onClick:a,children:(0,n.jsx)(o.c,{})},"icon-delete")]}},6160:(e,a,t)=>{t.d(a,{MZ:()=>n,a8:()=>r,aC:()=>o});var s=t(6584);const o=e=>{if(e){switch(e.split(".").pop().toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":return s.SQC;case"pdf":return s.I2R;case"doc":case"docx":return s.QdT;case"csv":case"xls":case"xlsx":return s.QBy;case"ppt":case"pptx":return s.umR;case"rar":return s.U5Y;default:return s.kx2}}},r=e=>{if(e){switch(e.split(".").pop().toLowerCase()){case"jpg":case"jpeg":case"png":case"gif":case"doc":case"docx":return"blue";case"pdf":return"red";case"csv":case"xls":case"xlsx":return"green";case"ppt":case"pptx":return"orange";case"rar":return"purple";default:return"black"}}},n=e=>{if(e){const a=1024,t=1024*a,s=1024*t;return e>=s?"".concat((e/s).toFixed(2)," GB"):e>=t?"".concat((e/t).toFixed(2)," MB"):e>=a?"".concat((e/a).toFixed(2)," KB"):"".concat(e," bytes")}return"Unknown"}},2664:(e,a,t)=>{t.d(a,{a:()=>r});var s=t(9012),o=t.n(s);const r=()=>new Promise(((e,a)=>{try{o().fire({title:"Are you sure?",text:"You will be delete",icon:"error",showCancelButton:!0,confirmButtonColor:"red",confirmButtonText:"Delete",cancelButtonText:"Cancel"}).then((a=>{a.isConfirmed?e({isConfirmed:!0}):e({isConfirmed:!1})}))}catch(t){console.log(t),a(t)}}))},196:(e,a,t)=>{t.d(a,{c:()=>r});var s=t(1120),o=t(5800);const r={async getUserFiles(){try{if(await o.c.getUserData()){return(await s.c.get("/files")).data}}catch(e){throw console.error("Error fetching user files:",e),e}},async uploadFiles(e){try{if(await o.c.getUserData()){const a=new FormData;e.forEach((e=>{a.append("files",e)}));return(await s.c.post("/files",a,{headers:{"Content-Type":"multipart/form-data"}})).data}}catch(a){throw console.error("Error uploading files:",a),a}},async deleteFile(e){try{if(await o.c.getUserData()){const a=await s.c.delete("/files/".concat(e));console.log("Delete File Success",a.data)}}catch(a){throw console.error("Error deleting file:",a),a}}}},5800:(e,a,t)=>{t.d(a,{c:()=>o});var s=t(1120);const o={async getUserData(){const e=localStorage.getItem("token");if(e)try{s.c.defaults.headers.common.Authorization="Bearer ".concat(e);return(await s.c.get("/auth/user")).data}catch(a){throw console.error("Error fetching user data:",a),a}},async UpdateUser(e,a){const t=localStorage.getItem("token");try{if(t){const t=await s.c.put("/auth/user/".concat(e),a);return console.log("Update User data",t.data),t.data.user}}catch(o){throw console.error("Error updating user data:",o),o}}}},3580:(e,a,t)=>{t.r(a),t.d(a,{default:()=>U});var s=t(9060),o=t(196),r=t(5800),n=t(9012),l=t.n(n),c=t(5548),i=t(8420),d=t(2664),u=t(9452),p=t(8668),m=t(3380),h=t.n(m),x=t(9308),w=t(7232),f=t(232),g=t(2152),b=t(1876),j=t(2556),C=t(1784),S=t(9500),v=t(6160),y=t(2496);const R=e=>{let{row:a,isSmallScreen:t}=e;return(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,y.jsx)(S.u,{icon:(0,v.aC)(a.filename),style:{color:(0,v.a8)(a.filename),marginRight:"5px"}}),(0,y.jsx)("div",{style:{fontWeight:"bold"},children:a.filename})]}),(0,y.jsxs)("div",{style:{fontSize:"12px",color:"gray"},children:["Size: ",a.size?(0,v.MZ)(a.size):"Unknown"]}),t&&(0,y.jsx)("div",{style:{fontSize:"11px"},children:h()(a.updatedAt).format("DD/MM/YYYY HH:mm:ss")})]},a._id)},D=(0,j.cp)((e=>(0,y.jsx)(w.c,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e})))((e=>{let{theme:a}=e;return{"& .MuiPaper-root":{borderRadius:6,marginTop:a.spacing(1),minWidth:180,color:"light"===a.palette.mode?"rgb(55, 65, 81)":a.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:a.palette.text.secondary,marginRight:a.spacing(1.5)}}}}})),k=e=>{let{setSelectedRow:a,handleDeleteRow:t,setSelectedFile:o,downloadFile:r}=e;const[n,l]=(0,s.useState)(null),i=Boolean(n),[d,u]=(0,s.useState)(null),p=()=>{u(null),l(null),o(null)},[m,w]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=()=>{w(window.innerWidth<=768)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[]);return[{name:"File Name",cell:e=>(0,y.jsx)(R,{row:e,isSmallScreen:m}),sortable:!0},{name:"Created",selector:e=>h()(e.createdAt).format("DD/MM/YYYY HH:mm:ss"),sortable:!0},{cell:e=>(0,y.jsxs)("div",{children:[(0,y.jsx)(c.c,{id:"demo-customized-button","aria-controls":i?"demo-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":i?"true":void 0,variant:"contained",onClick:t=>((e,t)=>{u(t),l(e.currentTarget),a(t)})(t,e),children:(0,y.jsx)(x.c,{})},"icon-button"),(0,y.jsxs)(D,{id:"demo-customized-menu",MenuListProps:{"aria-labelledby":"demo-customized-button"},anchorEl:n,open:i&&d===e,onClose:p,children:[(0,y.jsxs)(f.c,{onClick:()=>{r(e.path,e.filename),p()},disableRipple:!0,children:[(0,y.jsx)(b.c,{}),"Download"]}),(0,y.jsxs)(f.c,{onClick:()=>{t(e._id),p()},children:[(0,y.jsx)(C.c,{}),"Delete"]}),(0,y.jsxs)(f.c,{onClick:p,disableRipple:!0,children:[(0,y.jsx)(g.c,{}),"More"]})]})]}),width:"80px"}]};var H=t(12),L=t(6584),N=t(1120);const E=e=>{let{data:a}=e;return(0,y.jsx)("div",{className:"card mb-3",children:(0,y.jsx)("div",{className:"row g-0",children:(0,y.jsx)("div",{className:"col-md-8",children:(0,y.jsxs)("div",{className:"card-body text",children:[(0,y.jsx)("h5",{className:"card-title",children:a.filename}),(0,y.jsxs)("p",{className:"card-text",children:["( Size: ",a.size?(0,v.MZ)(a.size):"Unknown"," )"]}),(0,y.jsxs)("p",{className:"card-text",children:["\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e42\u0e14\u0e22:"," ",(0,y.jsxs)("small",{className:"text-body-secondary",children:[a.user.username,",(",a.user.fname," ",a.user.lname,") ("," ",a.user.role,", ",a.user.rank," )"]})]}),(0,y.jsxs)("p",{className:"card-text",children:["\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e40\u0e21\u0e37\u0e48\u0e2d"," ",(0,y.jsx)("small",{className:"text-body-secondary",children:h()(a.createdAt).format(" DD/MM/YYYY  HH:mm:ss ")})]}),(0,y.jsx)("p",{className:"card-text",children:(0,y.jsxs)("a",{href:"".concat(N.c.defaults.baseURL,"/").concat(a.path),className:"btn btn-primary mt-2",download:!0,target:"blank",children:[" ",(0,y.jsx)(S.u,{icon:L.SqF,className:"me-2"})," ","Download File"]})})]})})})})};var F=t(7360);const M=()=>{const[e,a]=(0,s.useState)([]),[t,n]=(0,s.useState)([]),[m,x]=(0,s.useState)([]),[w,f]=(0,s.useState)(!1),[g,b]=(0,s.useState)(null),[j,C]=(0,s.useState)(!1),[S,v]=(0,s.useState)([]),[R,D]=(0,s.useState)(""),[L,M]=(0,s.useState)(""),[U,Y]=(0,s.useState)(""),[z,P]=(0,s.useState)([]),[A,I]=(0,s.useState)([]),[T,O]=(0,s.useState)({}),[_,B]=(0,s.useState)(null),[W,Q]=(0,s.useState)(!1),[Z,G]=(0,s.useState)(!1);(0,s.useEffect)((()=>{X(),K()}),[]),(0,s.useEffect)((()=>{const e=t.filter((e=>{const a=e.filename.toLowerCase(),t=h()(e.updatedAt).format("DD/MM/YYYY HH:mm:ss");return""!==U?(a.includes(R.toLowerCase())||t.includes(R.toLowerCase()))&&e.user.username.toLowerCase().includes(U.toLowerCase()):a.includes(R.toLowerCase())||t.includes(R.toLowerCase())}));P(e)}),[R,U,t]),(0,s.useEffect)((()=>{const e=t.filter((e=>{const a=e.user.email.toLowerCase(),t=e.user.username.toLowerCase(),s=e.user.role.toLowerCase();return a.includes(U.toLowerCase())||t.includes(U.toLowerCase())||s.includes(U.toLowerCase())}));M(""),D(""),P(e)}),[U,t]),(0,s.useEffect)((()=>{const e=t.filter((e=>{const a=h()(e.updatedAt).format("YYYY-MM-DD HH:mm:ss");return""!==U?a.includes(R.toLowerCase())&&e.user.username.toLowerCase().includes(U.toLowerCase()):a.includes(L)}));P(e)}),[L,U,t]);const K=async()=>{const e=(await r.c.getUserData()).user;a(e)},X=async()=>{C(!0);try{const e=(await o.c.getUserFiles()).userFiles;n(e),P(e),x([]),f(!1),O({}),D(""),M(""),I([]),C(!1)}catch(e){console.error("Error fetching files:",e),C(!1)}},q=async(e,a)=>{try{const t="".concat(N.c.defaults.baseURL,"/").concat(e),s=await fetch(t),o=await s.blob(),r=URL.createObjectURL(o),n=document.createElement("a");n.href=r,n.download=a,n.click(),URL.revokeObjectURL(r)}catch(t){throw console.error("Error downloading file:",t),t}},V=z.slice().sort(((e,a)=>new Date(a.updatedAt)-new Date(e.updatedAt))),$=[...new Set(t.map((e=>e.user.username)))],J=(0,s.useRef)(null);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u.c,{title:"".concat(e.username," - Files"),columns:k({setSelectedRow:B,setSelectedFile:b,handleDeleteRow:async e=>{try{C(!0),Q(!0),G(!0),await(0,d.a)().then((async a=>{a.isConfirmed&&(await o.c.deleteFile(e),await X(),l().fire("Deleted Success!","","success"))})),C(!1),Q(!1),G(!1)}catch(a){console.error("Error deleting file:",a),C(!1)}},downloadFile:q}),data:V,fixedHeaderScrollHeight:"625px",paginationPerPage:5,expandableRowsComponent:E,onRowClicked:e=>{const a={...T};a[e._id]=!T[e._id],O(a)},onSelectedRowsChange:e=>{x(e.selectedRows),G(!0)},clearSelectedRows:w,subHeaderComponent:(0,y.jsx)("div",{className:"container",children:(0,y.jsx)("div",{className:"row",children:(0,y.jsx)("div",{className:"col-md-12",children:(0,y.jsxs)("div",{className:"row g-0",children:[(0,y.jsx)("div",{className:"col-md m-2",children:(0,y.jsx)("input",{className:"form-control",type:"search",placeholder:"Search File",value:R,onChange:e=>D(e.target.value)})}),(0,y.jsx)("div",{className:"col-md m-2",children:(0,y.jsxs)("select",{id:"userSelect",className:"form-select",value:U,onChange:e=>Y(e.target.value),children:[(0,y.jsx)("option",{value:"",children:"Search for user upload"}),$.map(((e,a)=>{const s=t.find((a=>a.user.username===e));return(0,y.jsxs)("option",{value:e,children:[e,", (",s.user.fname," ",s.user.lname,"), (",s.user.role,",",s.user.rank,")"]},a)}))]})}),(0,y.jsx)("div",{className:"col-md m-2",children:(0,y.jsx)("input",{className:"form-control",type:"date",ref:J,onChange:e=>M(e.target.value)})})]})})})}),contextActions:(0,y.jsx)(p.c,{handleDelete:async()=>{try{C(!0),Q(!0),G(!0),await(0,d.a)().then((async e=>{if(e.isConfirmed){if(m.length>0){const e=m.map((async e=>{try{const a=e._id;await o.c.deleteFile(a)}catch(a){console.error("Error deleting file:",a)}}));await Promise.all(e),x([]),f(!0),O({}),G(!1),await X(),C(!1),l().fire("Deleted Success!","","success")}}else C(!1)})),Q(!1)}catch(e){console.error("Error deleting files:",e),C(!1)}},handleDownload:async()=>{if(m.length>0)try{for(const e of m)await q(e.path,e.filename)}catch(e){console.error("Error downloading files:",e),l().fire("Error downloading files","","error")}else l().fire("No files selected for download","","warning")}}),actions:[(0,y.jsx)(H.cH,{to:"/fileupload",children:(0,y.jsx)(c.c,{"aria-label":"File Upload","data-toggle":"tooltip","data-placement":"top",title:"Upload File",children:(0,y.jsx)(i.c,{})},"file-upload")},"file-upload-link")]}),j&&(0,y.jsx)("div",{className:"modal fade show",id:"loadingModal","aria-labelledby":"loadingModalLabel","aria-modal":"true",role:"dialog",style:{display:"block",backgroundColor:"rgba(0, 0, 0, 0.5)"},tabIndex:"-1",children:j&&(0,y.jsx)("div",{className:"loading-overlay",children:(0,y.jsx)(F.s$,{type:"ThreeDots",color:"#007bff",height:50,width:50})})})]})},U=()=>(0,y.jsx)("div",{children:(0,y.jsx)(M,{})})},1876:(e,a,t)=>{var s=t(2411);a.c=void 0;var o=s(t(864)),r=t(2496);a.c=(0,o.default)((0,r.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"}),"GetApp")}}]);
//# sourceMappingURL=580.fc16a534.chunk.js.map